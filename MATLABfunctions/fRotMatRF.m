function RotMat = fRotMatRF(nu0,nu1,nuRF,t,phi)omega = (nu0 - nuRF)*2*pi;if any(nu1>0) == 1    omega1 = nu1*2*pi;    Omega = sqrt(omega1.^2 + omega.^2);    RotMat.xx = 1/2*(cos(Omega.*t).*Omega.^2+omega1.^2+cos(Omega.*t).*omega.^2)./(Omega.^2)+1/2*omega1.^2.*(1-cos(Omega.*t)).*cos(2*phi)./(Omega.^2);    RotMat.yy = 1/2*(cos(Omega.*t).*Omega.^2+omega1.^2+cos(Omega.*t).*omega.^2)./(Omega.^2)-1/2.*omega1.^2.*(1-cos(Omega.*t)).*cos(2*phi)./(Omega.^2);    RotMat.zz = omega.^2./(Omega.^2)+omega1.^2.*cos(Omega.*t)./(Omega.^2);    RotMat.xy = 1/2*omega1.^2.*(1-cos(Omega.*t)).*sin(2*phi)./(Omega.^2)-omega.*sin(Omega.*t)./Omega;    RotMat.yx = 1/2*omega1.^2.*(1-cos(Omega.*t)).*sin(2*phi)./(Omega.^2)+omega.*sin(Omega.*t)./Omega;    RotMat.xz = omega1.*omega.*(1-cos(Omega.*t)).*cos(phi)./(Omega.^2)+omega1.*sin(Omega.*t).*sin(phi)./Omega;    RotMat.zx = omega1.*omega.*(1-cos(Omega.*t)).*cos(phi)./(Omega.^2)-omega1.*sin(Omega.*t).*sin(phi)./Omega;    RotMat.yz = omega1.*omega.*(1-cos(Omega.*t)).*sin(phi)./(Omega.^2)-omega1.*sin(Omega.*t).*cos(phi)./Omega;    RotMat.zy = omega1.*omega.*(1-cos(Omega.*t)).*sin(phi)./(Omega.^2)+omega1.*sin(Omega.*t).*cos(phi)./Omega;else    RotMat.xx = cos(omega.*t);    RotMat.yy = RotMat.xx;    RotMat.zz = ones(size(nu0));    RotMat.xy = -sin(omega.*t);    RotMat.yx = -RotMat.xy;    RotMat.xz = 0*RotMat.zz;    RotMat.zx = RotMat.xz;    RotMat.yz = RotMat.xz;    RotMat.zy = RotMat.xz;end