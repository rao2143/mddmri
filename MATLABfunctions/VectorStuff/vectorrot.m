function r2 = vectorrot(r1,angles)alpha = angles(1);beta = angles(2);gamma = angles(3);x1 = r1(:,1);y1 = r1(:,2);z1 = r1(:,3);x2 = (cos(gamma)*cos(beta)*cos(alpha)-sin(gamma)*sin(alpha))*x1 + (cos(gamma)*cos(beta)*sin(alpha)+sin(gamma)*cos(alpha))*y1 + (-cos(gamma)*sin(beta))*z1;y2 = (-sin(gamma)*cos(beta)*cos(alpha)-cos(gamma)*sin(alpha))*x1 + (-sin(gamma)*cos(beta)*sin(alpha)+cos(gamma)*cos(alpha))*y1 + (sin(gamma)*sin(beta))*z1;z2 = (sin(beta)*cos(alpha))*x1 + (sin(beta)*sin(alpha))*y1 + (cos(beta))*z1;r2 = [x2 y2 z2];