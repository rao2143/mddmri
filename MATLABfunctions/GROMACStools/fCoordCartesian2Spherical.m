function coord_out = CoordCartesian2Spherical(coord_in)coord_out.r = sqrt(coord_in.x.^2 + coord_in.y.^2 + coord_in.z.^2);coord_out.ux = coord_in.x./coord_out.r;coord_out.uy = coord_in.y./coord_out.r;coord_out.uz = coord_in.z./coord_out.r;coord_out.theta = acos(coord_out.uz);coord_out.phi = atan2(coord_out.uy,coord_out.ux);if isfield(coord_in,'t')    coord_out.t = coord_in.t;end