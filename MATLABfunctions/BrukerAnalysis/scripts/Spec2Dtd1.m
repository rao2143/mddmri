clear allwd = cd;%DataDir = '/Users/daniel/NMRdata/AVII500/DT/';%DataDir = '/Users/daniel/NMRdata/AVII200/';%DataDir = '/opt/topspin2/data/DT/nmr';DataDir = '/opt/topspin/data/DT/nmr';cd(DataDir)%ExpNam = {'isoDW_test'}; expno = 72;%ExpNam = {'isoDW'}; expno = 10;%ExpNam = {'isoaniso_test'}; %expno = 24;%ExpNam = {'BileSaltCylinder'}; %expno = 3;%basl = [.02 .1 .9 .98]; lb = 20; si = 4*1024;%ll = 1959; ul = 2307;% ExpNam = {'Yeast20120919'}; expno = 30+(7:-1:2);% basl = [.05 .2 .8 .95]; lb = 10; si = 8*1024;% ExpNam = {'qMASopt'}; expno = 40;% basl = [.02 .35 .65 .98]; lb = 10; si = 16*1024;%ExpNam = {'Spindiff'}; expno = 44;%basl = [.05 .2 .8 .95]; lb = 10; si = 1*1024;ExpNam = {'Starch_DRcorr'}; expno = 13;AutoPhase = 1;AutoPhaseAll = 0;CheckBasline = 0;FindPeaks = 1;CheckPeaks = 0;PlotInterm = 0;thresh = .1;td1start = 16;signal = 'area'; signal = 'intensity';cd(ExpNam{1})if exist('expno') == 0    GetExpnosendfor nexp = 1:length(expno)    ConvertAcqus = 'N';    ConvertProcs = 'N';    MakeTextfile = 'N';    if exist([num2str(expno(nexp)) '/NMRacqus.mat']) == 0        ConvertAcqus = 'Y';    end    res = fExpnoInfo2(ConvertAcqus,MakeTextfile,ConvertProcs,expno(nexp));    eval(['load ' num2str(expno(nexp)) '/NMRacqus'])    if any(strcmp(NMRacqus.pulprog,{'DT_pgste','DT_pgse','DT_dfpgste','DT_fexsydpgste',...            'DT_T1ir','DT_fexsy3','DT_qMASdt'})) == 1        Spec2Dtd1        if AutoPhaseAll            AutoPhasetd1        end        PeakPick        fs = 20;        lw = 1;        %%        figure(1), clf        axes('position',[-.01 .15 1.02 .35],'FontSize',fs*.8)        plot(PP.ppm,PP.Ispec,'k','LineWidth',lw)        set(gca,'XDir','reverse','YTick',[],'LineWidth',1.5*lw,'Box','off','TickDir','out','Ycolor',[1 1 1])        axis('tight')        ylim = get(gca,'YLim');        ylim = .05*diff(ylim)*[-1 1] + ylim;        set(gca,'YLim',ylim)        xlabel(['\delta(' NMRacqus.nuc1 ') / ppm'],'FontSize',fs)        hold on        plot(PP.peakppm(td1start,:),PP.Ipeak(td1start,:),'bo','LineWidth',lw)        plot(PP.ppm,-1*ylim(1)+50*PP.Ispec,'k','LineWidth',.5*lw)        plot(PP.peakppm(td1start,:),-1*ylim(1)+50*PP.Ipeak(td1start,:),'bo','LineWidth',lw)        dleft = (1-.1)/Npeaks;        width = .9*dleft;        height = .3;        left = 1-width;        bottom = .6;        if Npeaks == 1, width = .8*1/2; end        for npeak = 1:Npeaks            axes('position',[left bottom width height],'FontSize',fs*.8)            semilogy(1:td1,PP.Ipeak(:,npeak),'bo')            hold on            axis('tight')            ylim = get(gca,'YLim');            %ylim = .05*abs(diff(ylim))*[-1 1] + abs(ylim); ylim(1) = 0;            ylim = ylim(2)*[1e-2 1.2];            xlim = get(gca,'XLim');            xlim = .05*diff(xlim)*[-1 1] + xlim;            set(gca,'XLim',xlim,'YLim',ylim,...                'TickLength',.02*[1 1],'TickDir','out','Box','off','YMinorTick','on','LineWidth',1.5*lw)            %set(gca,'YTick',[1e-3 1e-2 1e-1 1])            %set(gca,'XTick',[1e7 1e8 1e9 1e10 1e11])            title({[num2str(PP.peakppm(td1start,npeak),3) ' ppm'];...                },'FontSize',fs*.5)            left = left-dleft;            %set(gca,'XLim',xlim,'XScale','log')            if npeak < Npeaks                set(gca,'XTick',[],'YTick',[])            end        end               %%        %eval(['save ' num2str(expno(nexp)) '/FitDat FitDat'])        delete([num2str(expno(nexp)) '/ReportFig.*'])        eval(['print -depsc -loose ' num2str(expno(nexp)) '/ReportFig'])    endend