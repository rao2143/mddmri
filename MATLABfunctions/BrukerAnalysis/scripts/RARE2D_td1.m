clear allwd = fileparts(mfilename('fullpath'));%DataDir = '/opt/topspin2/data/DT/nmr';%DataDir = '/Users/daniel/NMRdata/AVII500/DT';%DataDir = '/opt/data/DT/nmr/';%DataDir = '/Users/daniel/Dropbox/NMRdata/SNC/HD3#600';%DataDir = '/Users/daniel/Dropbox/NMRdata/AVII500';% DataDir = '/Users/daniel/Dropbox/NMRdata/AV4_500/nmrsu';% DataDir = '/Users/daniel/Dropbox/NMRdata/AV4_500/daniel';%DataDir = '/Users/daniel/Dropbox/NMRdata/Darmstadt';DataDir = '/opt/nmrdata/daniel';ExpNam = {'mousetumor_trteaxde_dor_20220106'}; expno = [3]; expno = 898;%ExpNam = {'trteaxde_pptest_20210920'}; expno = [2 4 6]; expno = 13;%ExpNam = {'MIC5_stability_20210913'}; expno = [2 4 6]; expno = 2;%ExpNam = {'MIC5_stability_20210910'}; expno = [2 4 6]; expno = 6;%ExpNam = {'MIC5_stability_20210907'}; expno = [2 4 6]; expno = 6;%ExpNam = {'qdor_hex10mm_20210823'}; expno = [3];%ExpNam = {'qdor_hex10mm_20210816'}; expno = [40 42 44]; expno = 44;% ExpNam = {'MouseTumors_20170619'; 'LiquidCrystals_20160920'; 'LiquidCrystals_20160422'; 'GradientTest'; 'DTrare2d_setup'};%ExpNam = {'lamellar_278Kstability'}; expno = 3;%ExpNam = {'axderare2dms_test'}; expno = 14;%ExpNam = {'DTItest'}; expno = 339;%ExpNam = {'NafionDTI'}; expno = 35;%ExpNam = {'NafionDTI'}; expno = 31; %expno = [26:28 31:38]; %ExpNam = {'DTI_HHnerve'}; expno = 413;%ExpNam = {'MIC5_10mm_gradcalib'}; %expno = 130;% ExpNam = {'MIC5_10mm_setup'}; %expno = 9;%ExpNam = {'ToothPickPhantom'};%ExpNam = {'isoaniso_test'};%ExpNam = {'uFA_RARE'}; expno = 113;%ExpNam = {'DiffVACSY'}; expno = 127;%ExpNam = {'AOToct'}; expno = 108;%ExpNam = {'C14E5'}; expno = [66:69 79 81]; expno = 297;%ExpNam = {'MIC5_2H_setup'}; expno = [22 27]; expno = 22;%ExpNam = {'C14E5_3'}; expno = [15];%ExpNam = {'SjolundOpt'}; expno = 7:14; expno = 14;%ExpNam = {'MIC5_2H_setup'}; expno = [16 17]; expno = 18;%ExpNam = {'AOToct8'}; expno = 10;%ExpNam = {'C14E5_6'}; expno = 10;%ExpNam = {'AOToct_Eq1'}; expno = 4;%ExpNam = {'AOToct_Eq2'}; expno = 36;%ExpNam = {'AOToct_temp11'}; expno = 106;%ExpNam = {'Saupe_SliceTest'}; expno = 20;%ExpNam = {'AOToct_Eq2'}; expno = 116;%ExpNam = {'RARE2DAxSym_EddyTest'}; expno = 29;%ExpNam = {'MIC5test'}; expno = 60;%ExpNam = {'DTrare2d_setup'}; expno = 3;%ExpNam = {'LiquidCrystals_20160422'}; expno = 9;%ExpNam = {'LiquidCrystals_20160920'};%ExpNam = {'DTDRARE2Dms_test'}; expno = 66;%ExpNam = {'MOACRARE2D_160213'}; %expno = 3;%ExpNam = {'MOACRARE2D_test'}; %expno = 3;% ExpNam = {'Start'}; expno = 5;% ExpNam = {'DTrare2d_setup'}; expno = [10];lb = 150e-6;si = 64; si1 = si;si = 128; si1 = 64;fontsize = 15;cd(DataDir)%GetExpnamsfor ndir = 1:length(ExpNam)    ExpNam{ndir}    cd(ExpNam{ndir})    %clear expno    if exist('expno') == 0        GetExpnos    end    for nexp = 1:length(expno)        ConvertAcqus = 'Y';    ConvertProcs = 'N';    MakeTextfile = 'N';        if exist([num2str(expno(nexp)) '/NMRacqus.mat']) == 0            ConvertAcqus = 'Y';        end        res = fExpnoInfo2(ConvertAcqus,MakeTextfile,ConvertProcs,expno(nexp));        eval(['load ' num2str(expno(nexp)) '/NMRacqus'])        if any(strcmp(NMRacqus.pulprog,{'DT_rare2d','DT_6axderare2d','DT_axderare2dms','DT_axderare2d_av4','DT_axderare2d','DT_qVASrare2d','DT_ufarare2d','DT_rare2dt','DT_qVASdtirare2d','DT_qMASdtirare2d','DT_t1rare2d','DT_t2rare2d','DT_pgserare2d','DT_dtirare2d',...                'LT_moacrare2drs_Hong','DT_dpgserare2d','DT_dpgsezrare2d','DT_vdpgserare2d','DT_fexsyrare2d','DT_dpgsedtirare2d','DT_moacrare2drs'})) == 1                        %             try                RARE2Dtd1                Imax = abs(Itd1);                Imax(nudim.i/2+(0:2),nudim.j/2+(0:2),2:td1) = 0;                Imax(:,:,1) = 0;                Imax = max(reshape(Imax,numel(Imax),1));                rmax.i = max(r.i)*1e3;                rmax.j = max(r.j)*1e3;                figure(2), clf                colormap(hot(256));                clim = [0 1];                td1dim.x = ceil(11/8*sqrt(td1));                td1dim.y = ceil(8/11*sqrt(td1));                if any(strcmp(NMRacqus.pulprog,{'DT_dtirare2d','DT_dpgsedtirare2d'})) == 1                                            td1dim.x = 8;                    td1dim.y = ceil(td1/td1dim.x);                end                if td1>200                                            td1dim.x = 15;                    td1dim.y = 15;                end                width = .5/td1dim.x;                height = 1/td1dim.y;                ntd1 = 1;                for ycount = 1:td1dim.y                    for xcount = 1:td1dim.x                        if ntd1 <= td1                            axes('position',[(xcount-1)*width 1-ycount*height width height])                            Iplot = squeeze(abs(Itd1(:,:,ntd1)))/Imax;                            if tdim.i>tdim.j                                imagesc(r.j*1e3,r.i*1e3,Iplot,clim)                            else                                imagesc(r.i*1e3,r.j*1e3,Iplot',clim)                            end                            set(gca,'YDir','normal')                            axis equal, axis tight, axis off                        end                        ntd1 = ntd1+1;                    end                end                axes('position',[.55 .2 .4 .7])                Yin = squeeze(sum(sum(abs(Itd1(:,:,:)),1),2));                ph = plot(1:td1,Yin,'ko','MarkerSize',5);                if td1 > 1000                    set(ph,'Marker','.')                end                xlabel('td1')                axis tight                set(gca,'YLim',max(Yin(2:end))*[-.1 1.1])                delete([num2str(expno(nexp)) '/ReportFig*'])                delete([num2str(expno(nexp)) '/acqu*sconv'])                delete([num2str(expno(nexp)) '/*Dat.mat'])                delete([num2str(expno(nexp)) '/*.jpg'])                set(gcf, 'PaperPosition', [0 0 11 8.5],'PaperSize', [11 8.5]);                 eval(['print ' num2str(expno(nexp)) '/ReportFig -loose -dpdf'])%             catch%                 warning(['Error for ' ExpNam{ndir} ' expno ' num2str(expno(nexp)) ])%             end                    end    end    cd ..endcd(wd)