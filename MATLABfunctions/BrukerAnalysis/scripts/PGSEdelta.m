clear allwd = cd;%cd(['/Users/daniel/NMRdata/AVII200/'])cd(['/opt/topspin/data/DT/nmr'])%ExpNam = {'Yeast20120919'}; expno = 0 + (3:6);ExpNam = {'Spindiff'}; expno = 63:70; expno = 71:74; expno = 75:78; %expno = 79:82;ExpNam = {'Starch_DRcorr'}; expno = 103:110; expno = 111:118; expno = 119:126; expno = 127:134;expno = 135:142; expno = 143:150; expno = 151:170;td1start = 2;Imin = 1e-2;cd(ExpNam{1})eval(['load ' num2str(expno(1)) '/PeakDat'])Iplot = zeros(length(PP.X),PP.Npeaks,length(expno));bplot = zeros(length(PP.X),PP.Npeaks,length(expno));eval(['load ' num2str(expno(1)) '/FitDat'])I0 = FitDat.Y0; [dummy,I0] = ndgrid(1:length(PP.X),I0);for nexp = 1:length(expno)    eval(['load ' num2str(expno(nexp)) '/PeakDat'])    Iplot(:,:,nexp) = PP.Ipeak./I0;    bplot(:,:,nexp) = PP.X;    if strcmp(FitDat.signal,'area')==1        Iplot(:,:,nexp) = PP.Apeak./I0;    end    delete([num2str(expno(nexp)) '/ReportFig.*'])endeval(['load ' num2str(expno(1)) '/PeakDat'])eval(['load ' num2str(expno(1)) '/NMRacqus'])fs = 20;lw = 1;figure(1), clfaxes('position',[-.01 .15 1.02 .35],'FontSize',fs*.8)plot(PP.ppm,PP.Ispec,'k','LineWidth',lw)set(gca,'XDir','reverse','YTick',[],'LineWidth',1.5*lw,'Box','off',...    'TickDir','out','Ycolor',[1 1 1])axis('tight')ylim = get(gca,'YLim');ylim = .05*diff(ylim)*[-1 1] + ylim;set(gca,'YLim',ylim)xlabel(['\delta(' NMRacqus.nuc1 ') / ppm'],'FontSize',fs)hold onplot(PP.peakppm(td1start,:),PP.Ipeak(td1start,:),'bo','LineWidth',lw)plot(PP.ppm,-1*ylim(1)+50*PP.Ispec,'k','LineWidth',.5*lw)plot(PP.peakppm(td1start,:),-1*ylim(1)+50*PP.Ipeak(td1start,:),'bo','LineWidth',lw)dleft = (1-.1)/PP.Npeaks;width = .9*dleft;height = .3;left = 1-width;bottom = .6;if PP.Npeaks == 1, width = .4*1/2; endfor npeak = 1:PP.Npeaks    axes('position',[left bottom width height],'FontSize',fs*.8)    semilogy(reshape(bplot(:,npeak,:),length(PP.X),length(expno)),...        reshape(Iplot(:,npeak,:),length(PP.X),length(expno)),'-bo','LineWidth',lw)    hold on    semilogy(reshape(bplot(:,npeak,1),length(PP.X),1),...        reshape(Iplot(:,npeak,1),length(PP.X),1),'ro','LineWidth',2*lw)    axis('tight')    xlabel('b / m^-^2s')    ylim = get(gca,'YLim');    %ylim = .05*abs(diff(ylim))*[-1 1] + abs(ylim); ylim(1) = 0;    ylim = ylim(2)*[Imin 1.2];    xlim = get(gca,'XLim');    xlim = .05*diff(xlim)*[-1 1] + xlim;    set(gca,'XLim',xlim,'YLim',ylim,...        'TickLength',.02*[1 1],'TickDir','out','Box','off','YMinorTick','on','LineWidth',1.5*lw)    set(gca,'YTick',[1e-3 1e-2 1e-1 1])    %set(gca,'XTick',[1e7 1e8 1e9 1e10 1e11])    title({[num2str(PP.peakppm(PP.td1start,npeak),3) ' ppm']},'FontSize',fs*.5)    left = left-dleft;    %xlim = [min(PP.X)/2 max(PP.X)*2];    %set(gca,'XScale','log','XLim',xlim)    if npeak < PP.Npeaks        set(gca,'XTick',[],'YTick',[])    endenddelete([num2str(expno(nexp)) '/ReportFig.*'])eval(['print -depsc -loose ' num2str(expno(1)) '/ReportFig'])