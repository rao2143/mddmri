function Y = fGansmuller(Pin,Xin,Pnorm,Xnorm,Ynorm);if nargin == 2    Pnorm = ones(size(Pin));    Xnorm = 1;    Ynorm = 1;endPin = Pin.*Pnorm;Xin = Xin*Xnorm;S0 = Pin(1);splitting = Pin(2);R2 = Pin(3);Sinf = Pin(4);t = Xin;theta = pi*splitting.*t; %corresponds to Gansmuller Eq 13Sideal = besselj(0,theta) - 2/15*besselj(2,theta)...    - 2/63*besselj(4,theta) - 2/143*besselj(6,theta) ...    - 2/255*besselj(8,theta) - 2/399*besselj(10,theta) ...    - 2/575*besselj(12,theta); %Gansmuller Eq 14 with Fresnel functions converted to BesselS = S0*(Sinf + (1-Sinf)*Sideal.*exp(-R2*t)); %Gansmuller Eq 18Y = S/Ynorm;