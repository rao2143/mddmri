function E = ACME_AutoPhase(Pin,Iin,baslpoints,pivotpoint,skippoints)if nargin == 4;    skippoints = [];endphc0=Pin(1);phc1=Pin(2);si = length(Iin);phcorrfun = exp(i*(phc0*pi/180.*ones(1,si)'+phc1*pi/180*((1:si)'-pivotpoint)./si));I = Iin.*phcorrfun;I = I - mean(I(baslpoints));ReI = real(I);ReI(skippoints) = 0;D1ReI = abs(gradient(ReI));h = D1ReI/sum(D1ReI);h(find(h==0)) = 1;H = -sum(h.*log(h));F = zeros(size(ReI));F(find(ReI<0)) = 1;p = 1e-4/si^2*F.*ReI.^2;P = sum(p);E = H + P;%Pin%[H P E]