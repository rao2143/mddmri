function res = fExpnoInfo2(ConvertAcqus,MakeTextfile,ConvertProcs,expno)if nargin == 3    GetExpnosendif isempty(expno) == 0    if strcmp(ConvertAcqus,'Y') == 1        for nexp = 1:length(expno)            eval(['cd ' num2str(expno(nexp))])            structnam = 'NMRacqus';            res = unixtc('acqus','acqusconv');            fid = fopen('acqusconv','rt');            templine = fgetl(fid);            while ischar(templine),               if length(templine) > 4                   if strcmp('$$ 20',templine(1:5)) == 1                         value = templine(4:7);                         paranam = 'yearstr';                         eval([structnam '.' paranam ' = value;'])                         value = templine(9:10);                         paranam = 'monthstr';                         eval([structnam '.' paranam ' = value;'])                         value = templine(12:13);                         paranam = 'daystr';                         eval([structnam '.' paranam ' = value;'])                         value = templine(15:16);                         paranam = 'hourstr';                         eval([structnam '.' paranam ' = value;'])                         value = templine(18:19);                         paranam = 'minutestr';                         eval([structnam '.' paranam ' = value;'])                         value = templine(21:22);                         paranam = 'secondstr';                         eval([structnam '.' paranam ' = value;'])                         value = str2num(templine(4:7));                         paranam = 'year';                         eval([structnam '.' paranam ' = value;'])                         value = str2num(templine(9:10));                         paranam = 'month';                         eval([structnam '.' paranam ' = value;'])                         value = str2num(templine(12:13));                         paranam = 'day';                         eval([structnam '.' paranam ' = value;'])                         value = str2num(templine(15:16));                         paranam = 'hour';                         eval([structnam '.' paranam ' = value;'])                         value = str2num(templine(18:19));                         paranam = 'minute';                         eval([structnam '.' paranam ' = value;'])                         value = str2num(templine(21:22));                         paranam = 'second';                         eval([structnam '.' paranam ' = value;'])                         value = templine(35:length(templine));                         paranam = 'user';                         eval([structnam '.' paranam ' = value;'])                   end               end               if length(templine) > 3                   if strcmp('$$ /',templine(1:4)) == 1                       indxslash = find(templine == '/');                       value = templine(4:indxslash(length(indxslash)-1));                       paranam = 'datapath';                       eval([structnam '.' paranam ' = value;'])                   elseif strcmp('$$ C',templine(1:4)) == 1                       indxslash = find(templine == '/');                       value = templine(14:indxslash(length(indxslash)-1));                       paranam = 'datapath';                       eval([structnam '.' paranam ' = value;'])                   end               end               indxeq = find(templine == '=');               if ~isempty(indxeq)                    if strcmp('##$',templine(1:3)) == 1                        paranam = lower(templine(4:indxeq(1)-1));                        tempval = templine(indxeq+1:length(templine));                        indxs = find((tempval == '<') | (tempval == '>'));  % Find string                         indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                        if ~isempty(indxs)                            % Value is a string                            if numel(indxs) == 1                                value = tempval(indxs(1)+1:length(tempval));                            else                                value = tempval(indxs(1)+1:indxs(2)-1);                            end                            eval([structnam '.' paranam ' = value;'])                        elseif ~isempty(indxv)                                               % Value is a vector at next line(s)                            indxd = find(tempval == '.');                            indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                            value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                            eval([structnam '.' paranam ' = ' value ';'])                        else                            % Value is a scalar                            value = tempval;                            if strcmp(value,' no') == 1                                assignin('base',paranam,'no')                            elseif strcmp(value,' yes') == 1                                assignin('base',paranam,'yes')                            else                                eval([structnam '.' paranam ' = ' value ';'])                            end                        end                    end               end               templine = fgetl(fid);            end            fclose(fid);            VarNam = {'p','d','pl','l','cnst','in','inp'};            for nVar = 1:length(VarNam)                for m = 1:length(eval([structnam '.' VarNam{nVar}]))                    eval([structnam '.' VarNam{nVar} num2str(m-1) ' = ' structnam '.' VarNam{nVar} '(' num2str(m) ');']);                end            end            if exist('vdlist') == 2                fidvd = fopen('vdlist');                NMRacqus.vd = fscanf(fidvd,'%f');                fclose(fidvd);            end            if exist('vclist') == 2                fidvc = fopen('vclist');                NMRacqus.vc = fscanf(fidvc,'%f');                fclose(fidvc);            end            if exist('vplist') == 2                fidvp = fopen('vplist');                NMRacqus.vp = fscanf(fidvp,'%f');                fclose(fidvp);            end                        if exist('fq1list') == 2                fidfq1 = fopen('fq1list');                templine = fgetl(fidfq1);                NMRacqus.fq1 = fscanf(fidfq1,'%f');                fclose(fidfq1);            end                        if exist('Df') == 2                fidDf = fopen('Df');                NMRacqus.Df = fscanf(fidDf,'%f');                fclose(fidDf);            end            if exist('Dm') == 2                fidDm = fopen('Dm');                NMRacqus.Dm = fscanf(fidDm,'%f');                fclose(fidDm);            end            NMRacqus.dw = .5/NMRacqus.sw_h;            NMRacqus.aq = NMRacqus.dw*NMRacqus.td;            save NMRacqus NMRacqus            delete acqusconv            if exist('acqu2s') == 2                structnam = 'NMRacqu2s';                res = unixtc('acqu2s','acqu2sconv');                fid = fopen('acqu2sconv','rt');                templine = fgetl(fid);                while ischar(templine),                   if length(templine) > 4                       if strcmp('$$ 20',templine(1:5)) == 1                             value = templine(4:length(templine));                             paranam = 'datetimeuser';                             eval([structnam '.' paranam ' = value;'])                       end                   end                   if length(templine) > 3                       if strcmp('$$ /',templine(1:4)) == 1                             value = templine(4:length(templine));                             paranam = 'datapath';                             eval([structnam '.' paranam ' = value;'])                       end                   end                   indxeq = find(templine == '=');                   if ~isempty(indxeq)                        if strcmp('##$',templine(1:3)) == 1                            paranam = lower(templine(4:indxeq(1)-1));                            tempval = templine(indxeq+1:length(templine));                            indxs = find((tempval == '<') | (tempval == '>'));  % Find string                             indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                            if ~isempty(indxs)                                % Value is a string                                if numel(indxs) == 1                                    value = tempval(indxs(1)+1:length(tempval));                                else                                    value = tempval(indxs(1)+1:indxs(2)-1);                                end                                eval([structnam '.' paranam ' = value;'])                            elseif ~isempty(indxv)                                                   % Value is a vector at next line(s)                                indxd = find(tempval == '.');                                indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                                value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                                eval([structnam '.' paranam ' = ' value ';'])                            else                                % Value is a scalar                                value = tempval;                                if strcmp(value,' no') == 1                                    assignin('base',paranam,'no')                                elseif strcmp(value,' yes') == 1                                    assignin('base',[structnam '.' paranam],'yes')                                else                                    eval([structnam '.' paranam ' = ' value ';'])                                end                            end                        end                   end                   templine = fgetl(fid);                end                save NMRacqu2s NMRacqu2s                fclose(fid);                delete acqu2sconv            end                        if exist('acqu3s') == 2                structnam = 'NMRacqu3s';                res = unixtc('acqu3s','acqu3sconv');                fid = fopen('acqu3sconv','rt');                templine = fgetl(fid);                while ischar(templine),                   if length(templine) > 4                       if strcmp('$$ 20',templine(1:5)) == 1                             value = templine(4:length(templine));                             paranam = 'datetimeuser';                             eval([structnam '.' paranam ' = value;'])                       end                   end                   if length(templine) > 3                       if strcmp('$$ /',templine(1:4)) == 1                             value = templine(4:length(templine));                             paranam = 'datapath';                             eval([structnam '.' paranam ' = value;'])                       end                   end                   indxeq = find(templine == '=');                   if ~isempty(indxeq)                        if strcmp('##$',templine(1:3)) == 1                            paranam = lower(templine(4:indxeq(1)-1));                            tempval = templine(indxeq+1:length(templine));                            indxs = find((tempval == '<') | (tempval == '>'));  % Find string                             indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                            if ~isempty(indxs)                                % Value is a string                                if numel(indxs) == 1                                    value = tempval(indxs(1)+1:length(tempval));                                else                                    value = tempval(indxs(1)+1:indxs(2)-1);                                end                                eval([structnam '.' paranam ' = value;'])                            elseif ~isempty(indxv)                                                   % Value is a vector at next line(s)                                indxd = find(tempval == '.');                                indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                                value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                                eval([structnam '.' paranam ' = ' value ';'])                            else                                % Value is a scalar                                value = tempval;                                if strcmp(value,' no') == 1                                    assignin('base',paranam,'no')                                elseif strcmp(value,' yes') == 1                                    assignin('base',[structnam '.' paranam],'yes')                                else                                    eval([structnam '.' paranam ' = ' value ';'])                                end                            end                        end                   end                   templine = fgetl(fid);                end                save NMRacqu3s NMRacqu3s                fclose(fid);                delete acqu3sconv            end            cd ..        end    end    if strcmp(ConvertProcs,'Y') == 1        for nexp = 1:length(expno)            eval(['cd ' num2str(expno(nexp))])            if exist('pdata') == 7                cd pdata                cd 1                structnam = 'NMRprocs';                res = unixtc('procs','procsconv');                fid = fopen('procsconv','rt');                templine = fgetl(fid);                while ischar(templine),                   if length(templine) > 4                       if strcmp('$$ 20',templine(1:5)) == 1                             value = templine(4:length(templine));                             paranam = 'datetimeuser';                             eval([structnam '.' paranam ' = value;'])                       end                   end                   if length(templine) > 3                       if strcmp('$$ /',templine(1:4)) == 1                           indxslash = find(templine == '/');                           value = templine(4:indxslash(length(indxslash)-1));                           paranam = 'datapath';                           eval([structnam '.' paranam ' = value;'])                       end                   end                   indxeq = find(templine == '=');                   if ~isempty(indxeq)                        if strcmp('##$',templine(1:3)) == 1                            paranam = lower(templine(4:indxeq(1)-1));                            tempval = templine(indxeq+1:length(templine));                            indxs = find((tempval == '<') | (tempval == '>'));  % Find string                             indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                            if ~isempty(indxs)                                % Value is a string                                if numel(indxs) == 1                                    value = tempval(indxs(1)+1:length(tempval));                                else                                    value = tempval(indxs(1)+1:indxs(2)-1);                                end                                eval([structnam '.' paranam ' = value;'])                            elseif ~isempty(indxv)                                                   % Value is a vector at next line(s)                                indxd = find(tempval == '.');                                indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                                value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                                eval([structnam '.' paranam ' = ' value ';'])                            else                                % Value is a scalar                                value = tempval;                                if strcmp(value,' no') == 1                                    %assignin('base',paranam,'no')                                elseif strcmp(value,' yes') == 1                                    %assignin('base',[structnam '.' paranam],'yes')                                else                                    eval([structnam '.' paranam ' = ' value ';'])                                end                            end                        end                   end                   templine = fgetl(fid);                end                save NMRprocs NMRprocs                fclose(fid);                delete procsconv                if exist('proc2s') == 2                    structnam = 'NMRproc2s';                    res = unixtc('proc2s','proc2sconv');                    fid = fopen('proc2sconv','rt');                    templine = fgetl(fid);                    while ischar(templine),                       if length(templine) > 4                           if strcmp('$$ 20',templine(1:5)) == 1                                 value = templine(4:length(templine));                                 paranam = 'datetimeuser';                                 eval([structnam '.' paranam ' = value;'])                           end                       end                       if length(templine) > 3                           if strcmp('$$ /',templine(1:4)) == 1                                 value = templine(4:length(templine));                                 paranam = 'datapath';                                 eval([structnam '.' paranam ' = value;'])                           end                       end                       indxeq = find(templine == '=');                       if ~isempty(indxeq)                            if strcmp('##$',templine(1:3)) == 1                                paranam = lower(templine(4:indxeq(1)-1));                                tempval = templine(indxeq+1:length(templine));                                indxs = find((tempval == '<') | (tempval == '>'));  % Find string                                 indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                                if ~isempty(indxs)                                    % Value is a string                                    if numel(indxs) == 1                                        value = tempval(indxs(1)+1:length(tempval));                                    else                                        value = tempval(indxs(1)+1:indxs(2)-1);                                    end                                    eval([structnam '.' paranam ' = value;'])                                elseif ~isempty(indxv)                                                       % Value is a vector at next line(s)                                    indxd = find(tempval == '.');                                    indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                                    value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                                    eval([structnam '.' paranam ' = ' value ';'])                                else                                    % Value is a scalar                                    value = tempval;                                    if strcmp(value,' no') == 1                                        assignin('base',paranam,'no')                                    elseif strcmp(value,' yes') == 1                                        %assignin('base',[structnam '.' paranam],'yes')                                    else                                        eval([structnam '.' paranam ' = ' value ';'])                                    end                                end                            end                       end                       templine = fgetl(fid);                    end                    save NMRproc2s NMRproc2s                    fclose(fid);                    delete proc2sconv                end                cd .., cd ..            end            cd ..        end    end    if strcmp(MakeTextfile,'Y') == 1        delete('ExpnoInfo.pdf','ExpnoInfo.aux','ExpnoInfo.log','ExpnoInfo.txt')        fid = fopen('ExpnoInfo.tex','w');        fprintf(fid,'%s\r','\documentclass[a4paper,twocolumn]{article}');        fprintf(fid,'%s\r','\usepackage{graphicx}');        fprintf(fid,'%s\r','\usepackage{epstopdf}');        fprintf(fid,'%s\r\r','\begin{document}');        eval(['cd ' num2str(expno(1))])        load NMRacqus        oldNMRacqus = NMRacqus; oldNMRacqu2s = NMRacqus;        fprintf(fid,'%s\r',['\title{' NMRacqus.user ' ' NMRacqus.yearstr '-'...            NMRacqus.monthstr '-' NMRacqus.daystr '}']);          ParaVal = NMRacqus.datapath;        ParaVal(find(ParaVal=='_')) = '-';        fprintf(fid,'%s\r\r',['\author{' ParaVal '}']);        fprintf(fid,'%s\r\r',['\maketitle ']);        cd ..        for nexp = 1:length(expno)            eval(['cd ' num2str(expno(nexp))])            %expno(nexp)            load NMRacqus            fprintf(fid,'%s',[' \noindent \textbf{' num2str(expno(nexp)) ')} ']);            ParaToList = {'probhd','pulprog'};            for npara = 1:length(ParaToList)                ParaVal = eval(['NMRacqus.' ParaToList{npara}]);                oldParaVal = eval(['oldNMRacqus.' ParaToList{npara}]);                if ([strcmp(ParaVal,oldParaVal) == 0 | nexp == 1])                    ParaVal(find(ParaVal=='_')) = '-';                    fprintf(fid,'%s',[ParaVal ', ']);                end            end            if strcmp(NMRacqus.nuc2,'off') == 1                ParaToList = {'nuc1'};            else                ParaToList = {'nuc1','nuc2'};            end            for npara = 1:length(ParaToList)                ParaVal = eval(['NMRacqus.' ParaToList{npara}]);                oldParaVal = eval(['oldNMRacqus.' ParaToList{npara}]);                if ([strcmp(ParaVal,oldParaVal) == 0 | nexp == 1])                    fprintf(fid,'%s',[ParaToList{npara} ' ' ParaVal ', ']);                end            end            ParaToList = {'sw','td','de','ns','d1','te','p1','pl1'};            ParaToList2 = {'td'};            if any(strcmp(NMRacqus.probhd,{'4 mm MAS BB/1H K3167/0111',...                    '4 mm HRMAS 1H-13C/31P Z-GRD B3175/0415','2.5 mm MAS BB/1H H9558/0009'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'masr'};            end            if any(strcmp(NMRacqus.pulprog,{'hpdec.av','hxhetcor.av','DT_cp','ineptrd','DT_rpdlf'...                    ,'DT_cprpdlf','DT_inept'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                                        'pl12','p31','aq'}; %AV4 %'cpdprg2','pl12','p31','aq'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_hetcorin','DT_hetcorcp','DT_sdhetcorin','DT_sdhetcorcp',})) == 1                ParaToList2 = {ParaToList2{1:length(ParaToList2)}, ...                                        'sw'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_sdhetcorin','DT_sdhetcorcp',})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                                        'd8'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_rpdlf','DT_cprpdlf'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p32','l1'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_cp','DT_hetcorcp','DT_cprpdlf'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p15','pl21','pl22'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_pgse'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p2','d2','d3','d4','d6','cnst3'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_rare2d','DT_t1rare2d',...                    'DT_t2rare2d','DT_dtirare2d','DT_qVASdtirare2d','DT_axderare2d','DT_axderare2d_av4'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p12','cnst11','cnst12','cnst13',...                    'cnst21','cnst22','cnst23','cnst31','cnst32',...                    'cnst33','cnst34','cnst35','cnst36'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_dtirare2d',...                    'DT_qVASdtirare2d','DT_axderare2d','DT_axderare2d_av4','DT_qVAS'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'd2','d3','d4','d6','cnst1','cnst2','cnst3'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_pgseisoaniso'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'd2','d3','d4','d6','cnst2','cnst7','cnst8','cnst9'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_tbppgste'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'd2','d3','d4','d5','d6','d12','cnst1','cnst4'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_rare2d','DT_t1rare2d','DT_t2rare2d','DT_pgserare2d','DT_dtirare2d',...                'DT_dpgserare2d','DT_dpgsezrare2d','DT_vdpgserare2d','DT_fexsyrare2d','DT_dpgsedtirare2d',...                'DT_axderare2d','DT_6axderare2d','DT_trtevcaxderare2d'})) == 1                                        ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p12','d40','l1',...                    'd32','d33','cnst11','cnst12','cnst13','cnst21','cnst22','cnst23',...                    'cnst31','cnst32','cnst33','cnst34','cnst35','cnst36'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_fexsy3','DT_fexsy4','DT_fexsy4imge1d'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p2','d2','d3','d4','d6','cnst3','cnst9','l2','cnst6','l11'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_imse2dssdw'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p2','p3','pl11','cnst31','cnst22','cnst13','d2','d3','d4','d6'...                    ,'cnst1','cnst2','cnst3'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_imge3d'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'd32','d33','cnst21','cnst22','cnst13'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_imse2dss'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p2','p3','pl11','d4','cnst31','cnst22','cnst13'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_fexsyimse2dss'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'p2','d2','d3','d4','d6','cnst2','cnst8','l1','l2','l3','cnst4','l11'};            end            if any(strcmp(NMRacqus.pulprog,{'noesyph'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'd8'};            end            if any(strcmp(NMRacqus.pulprog,{'DT_inxt1rho','DT_cpxt1rho'})) == 1                ParaToList = {ParaToList{1:length(ParaToList)}, ...                    'pl13'};            end            for npara = 1:length(ParaToList)                ParaVal = eval(['NMRacqus.' ParaToList{npara}]);                oldParaVal = eval(['oldNMRacqus.' ParaToList{npara}]);                if isempty(oldParaVal) == 1                    oldParaVal = 0;                end%                 if ([ParaVal ~= oldParaVal | nexp == 1])%                     fprintf(fid,'%s',[ParaToList{npara} '=' num2str(ParaVal) ', ']);%                 end                if nexp == 1                    fprintf(fid,'%s',[ParaToList{npara} '=' num2str(ParaVal) ', ']);                end                if ischar(ParaVal) == 0                    if ParaVal ~= oldParaVal                        fprintf(fid,'%s',[ParaToList{npara} '=' num2str(ParaVal) ', ']);                    end                else                    if strcmp(ParaVal,oldParaVal)==0                        fprintf(fid,'%s',[ParaToList{npara} '=' ParaVal ', ']);                    end                end            end            if exist('NMRacqu2s.mat') == 2                load NMRacqu2s                for npara = 1:length(ParaToList2)                    ParaVal = eval(['NMRacqu2s.' ParaToList2{npara}]);                    oldParaVal = eval(['oldNMRacqu2s.' ParaToList2{npara}]);                    if nexp == 1                        fprintf(fid,'%s',[ParaToList2{npara} '1=' num2str(ParaVal) ', ']);                    end                    if ischar(ParaVal) == 0                        if ParaVal ~= oldParaVal                            fprintf(fid,'%s',[ParaToList2{npara} '1=' num2str(ParaVal) ', ']);                        end                    else                        if strcmp(ParaVal,oldParaVal)==0                            fprintf(fid,'%s',[ParaToList2{npara} '1=' ParaVal ', ']);                        end                    end                end                oldNMRacqu2s = NMRacqu2s;            end            hourstring = num2str(NMRacqus.hour);            if NMRacqus.hour < 10                hourstring = ['0' num2str(NMRacqus.hour)];            end            minutestring = num2str(NMRacqus.minute);            if NMRacqus.minute < 10                minutestring = ['0' num2str(NMRacqus.minute)];            end            fprintf(fid,'%s',[NMRacqus.yearstr NMRacqus.monthstr NMRacqus.daystr ' ' hourstring ':' minutestring]);            if exist('pdata') == 7                cd pdata, cd 1                fid2 = fopen('title','rt');                templine = fgetl(fid2);                numline = 1;                title{numline} = '';                while ischar(templine)                    pos = find(templine == '#');                    if isempty(pos) == 0                        templine = [templine(1:pos-1) '\' templine(pos:length(templine))];                    end                    pos = find(templine == '%');                    if isempty(pos) == 0                        templine = [templine(1:pos-1) '\' templine(pos:length(templine))];                    end                    title{numline} = templine;                    templine = fgetl(fid2);                    numline = numline + 1;                end                fclose(fid2);                fprintf(fid,'\r\r%s','');                if nexp == 1                    for nline = 1:length(title)                        ParaVal = title{nline};                        ParaVal(find(ParaVal=='_')) = '-';                        fprintf(fid,'%s\r\r',['\noindent ' ParaVal]);                    end                    oldtitle = title;                elseif length(title) ~= length(oldtitle)                    for nline = 1:length(title)                        ParaVal = title{nline};                        ParaVal(find(ParaVal=='_')) = '-';                        fprintf(fid,'%s\r\r',['\noindent ' ParaVal]);                    end                    oldtitle = title;                else                    if all(strcmp(title,oldtitle)) ~= 1                        for nline = 1:length(title)                            ParaVal = title{nline};                            ParaVal(find(ParaVal=='_')) = '-';                            fprintf(fid,'%s\r\r',['\noindent ' ParaVal]);                        end                    end                    oldtitle = title;                end                clear title                cd .., cd ..            end            oldNMRacqus = NMRacqus;            cd ..        end        figcount = 0;        for nexp = 1:length(expno)            eval(['cd ' num2str(expno(nexp))])                        if exist('ReportFig.eps') == 2                delete('ReportFig.eps')            end                        if any([exist('ReportFig.eps') == 2; exist('ReportFig.pdf') == 2])                figcount = figcount+1;                                load NMRacqus                ParaVal = NMRacqus.pulprog;                 ParaVal(find(ParaVal=='_')) = '-';                                if any(figcount == [1:6:601]) == 1                    fprintf(fid,'%s\r','\clearpage');                end                fprintf(fid,'%s\r','\begin{figure}');                fprintf(fid,'%s\r',['  \includegraphics[width=0.4\textwidth]{' num2str(expno(nexp)) '/ReportFig}']);                 if exist('ReportFigCaption.mat') == 2                   load ReportFigCaption                   fprintf(fid,'%s\r',['\caption{\textbf{' num2str(expno(nexp)) ')} ' ParaVal ' ' ReportFigCaption '}']);                else                   fprintf(fid,'%s\r',['\caption{\textbf{' num2str(expno(nexp)) ')} ' ParaVal '}']);                end                fprintf(fid,'%s\r\r','\end{figure}');            end            cd ..        end        fprintf(fid,'%s\r','');        fprintf(fid,'%s\r','\end{document}');        fclose(fid);    end    end    res = 1;