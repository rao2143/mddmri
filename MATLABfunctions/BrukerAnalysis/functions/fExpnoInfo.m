function res = fExpnoInfo(ConvertAcqus,MakeTextfile,ConvertProcs,expno)if nargin == 3    DirList = dir;    [DirSize1,DirSize2] = size(DirList);    expno = [];    for ndir = 1:DirSize1        expnotest = str2num(getfield(DirList,{ndir,1},'name'));        if isempty(expnotest) == 0            expno = [expno expnotest];        end    end    expno = sort(expno,'ascend');endif strcmp(ConvertAcqus,'Y') == 1    for nexp = 1:length(expno)        eval(['cd ' num2str(expno(nexp))])        structnam = 'NMRacqus';        res = unixtc('acqus','acqusconv');        fid = fopen('acqusconv','rt');        templine = fgetl(fid);        while ischar(templine),           if length(templine) > 4               if strcmp('$$ 20',templine(1:5)) == 1                     value = templine(4:length(templine));                     paranam = 'datetimeuser';                     eval([structnam '.' paranam ' = value;'])               end           end           if length(templine) > 3               if strcmp('$$ /',templine(1:4)) == 1                   indxslash = find(templine == '/');                   value = templine(4:indxslash(length(indxslash)-1));                   paranam = 'datapath';                   eval([structnam '.' paranam ' = value;'])               end           end           indxeq = find(templine == '=');           if ~isempty(indxeq)                if strcmp('##$',templine(1:3)) == 1                    paranam = lower(templine(4:indxeq(1)-1));                    tempval = templine(indxeq+1:length(templine));                    indxs = find((tempval == '<') | (tempval == '>'));  % Find string                     indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                    if ~isempty(indxs)                        % Value is a string                        if numel(indxs) == 1                            value = tempval(indxs(1)+1:length(tempval));                        else                            value = tempval(indxs(1)+1:indxs(2)-1);                        end                        eval([structnam '.' paranam ' = value;'])                    elseif ~isempty(indxv)                                           % Value is a vector at next line(s)                        indxd = find(tempval == '.');                        indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                        value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                        eval([structnam '.' paranam ' = ' value ';'])                    else                        % Value is a scalar                        value = tempval;                        if strcmp(value,' no') == 1                            assignin('base',paranam,'no')                        elseif strcmp(value,' yes') == 1                            assignin('base',[structnam '.' paranam],'yes')                        else                            eval([structnam '.' paranam ' = ' value ';'])                        end                    end                end           end           templine = fgetl(fid);        end        if exist('vdlist') == 2            fidvd = fopen('vdlist');            NMRacqus.vd = fscanf(fidvd,'%f');            fclose(fid);        end                  save NMRacqus NMRacqus        if exist('acqu2s') == 2            structnam = 'NMRacqu2s';            res = unixtc('acqu2s','acqu2sconv');            fid = fopen('acqu2sconv','rt');            templine = fgetl(fid);            while ischar(templine),               if length(templine) > 4                   if strcmp('$$ 20',templine(1:5)) == 1                         value = templine(4:length(templine));                         paranam = 'datetimeuser';                         eval([structnam '.' paranam ' = value;'])                   end               end               if length(templine) > 3                   if strcmp('$$ /',templine(1:4)) == 1                         value = templine(4:length(templine));                         paranam = 'datapath';                         eval([structnam '.' paranam ' = value;'])                   end               end               indxeq = find(templine == '=');               if ~isempty(indxeq)                    if strcmp('##$',templine(1:3)) == 1                        paranam = lower(templine(4:indxeq(1)-1));                        tempval = templine(indxeq+1:length(templine));                        indxs = find((tempval == '<') | (tempval == '>'));  % Find string                         indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                        if ~isempty(indxs)                            % Value is a string                            if numel(indxs) == 1                                value = tempval(indxs(1)+1:length(tempval));                            else                                value = tempval(indxs(1)+1:indxs(2)-1);                            end                            eval([structnam '.' paranam ' = value;'])                        elseif ~isempty(indxv)                                               % Value is a vector at next line(s)                            indxd = find(tempval == '.');                            indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                            value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                            eval([structnam '.' paranam ' = ' value ';'])                        else                            % Value is a scalar                            value = tempval;                            if strcmp(value,' no') == 1                                assignin('base',paranam,'no')                            elseif strcmp(value,' yes') == 1                                assignin('base',[structnam '.' paranam],'yes')                            else                                eval([structnam '.' paranam ' = ' value ';'])                            end                        end                    end               end               templine = fgetl(fid);            end            save NMRacqu2s NMRacqu2s        end        cd ..    endendif strcmp(ConvertProcs,'Y') == 1    for nexp = 1:length(expno)        eval(['cd ' num2str(expno(nexp))])        if exist('pdata') == 7            cd pdata            cd 1            structnam = 'NMRprocs';            res = unixtc('procs','procsconv');            fid = fopen('procsconv','rt');            templine = fgetl(fid);            while ischar(templine),               if length(templine) > 4                   if strcmp('$$ 20',templine(1:5)) == 1                         value = templine(4:length(templine));                         paranam = 'datetimeuser';                         eval([structnam '.' paranam ' = value;'])                   end               end               if length(templine) > 3                   if strcmp('$$ /',templine(1:4)) == 1                       indxslash = find(templine == '/');                       value = templine(4:indxslash(length(indxslash)-1));                       paranam = 'datapath';                       eval([structnam '.' paranam ' = value;'])                   end               end               indxeq = find(templine == '=');               if ~isempty(indxeq)                    if strcmp('##$',templine(1:3)) == 1                        paranam = lower(templine(4:indxeq(1)-1));                        tempval = templine(indxeq+1:length(templine));                        indxs = find((tempval == '<') | (tempval == '>'));  % Find string                         indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                        if ~isempty(indxs)                            % Value is a string                            if numel(indxs) == 1                                value = tempval(indxs(1)+1:length(tempval));                            else                                value = tempval(indxs(1)+1:indxs(2)-1);                            end                            eval([structnam '.' paranam ' = value;'])                        elseif ~isempty(indxv)                                               % Value is a vector at next line(s)                            indxd = find(tempval == '.');                            indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                            value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                            eval([structnam '.' paranam ' = ' value ';'])                        else                            % Value is a scalar                            value = tempval;                            if strcmp(value,' no') == 1                                %assignin('base',paranam,'no')                            elseif strcmp(value,' yes') == 1                                %assignin('base',[structnam '.' paranam],'yes')                            else                                eval([structnam '.' paranam ' = ' value ';'])                            end                        end                    end               end               templine = fgetl(fid);            end            save NMRprocs NMRprocs            if exist('proc2s') == 2                structnam = 'NMRproc2s';                res = unixtc('proc2s','proc2sconv');                fid = fopen('proc2sconv','rt');                templine = fgetl(fid);                while ischar(templine),                   if length(templine) > 4                       if strcmp('$$ 20',templine(1:5)) == 1                             value = templine(4:length(templine));                             paranam = 'datetimeuser';                             eval([structnam '.' paranam ' = value;'])                       end                   end                   if length(templine) > 3                       if strcmp('$$ /',templine(1:4)) == 1                             value = templine(4:length(templine));                             paranam = 'datapath';                             eval([structnam '.' paranam ' = value;'])                       end                   end                   indxeq = find(templine == '=');                   if ~isempty(indxeq)                        if strcmp('##$',templine(1:3)) == 1                            paranam = lower(templine(4:indxeq(1)-1));                            tempval = templine(indxeq+1:length(templine));                            indxs = find((tempval == '<') | (tempval == '>'));  % Find string                             indxv = find((tempval == '(') | (tempval == ')'));  % Find vector                            if ~isempty(indxs)                                % Value is a string                                if numel(indxs) == 1                                    value = tempval(indxs(1)+1:length(tempval));                                else                                    value = tempval(indxs(1)+1:indxs(2)-1);                                end                                eval([structnam '.' paranam ' = value;'])                            elseif ~isempty(indxv)                                                   % Value is a vector at next line(s)                                indxd = find(tempval == '.');                                indxv = str2num(tempval(indxd(2)+1:indxv(2)-1))+1;  % Length of vector                                value = ['[' num2str(fscanf(fid,'%f',indxv)') ']'];                                eval([structnam '.' paranam ' = ' value ';'])                            else                                % Value is a scalar                                value = tempval;                                if strcmp(value,' no') == 1                                    assignin('base',paranam,'no')                                elseif strcmp(value,' yes') == 1                                    %assignin('base',[structnam '.' paranam],'yes')                                else                                    eval([structnam '.' paranam ' = ' value ';'])                                end                            end                        end                   end                   templine = fgetl(fid);                end                save NMRproc2s NMRproc2s            end            cd .., cd ..        end        cd ..    endendif strcmp(MakeTextfile,'Y') == 1    fid = fopen('ExpnoInfo.txt','w');    eval(['cd ' num2str(expno(1))])    load NMRacqus    fprintf(fid,'%s\r\r',NMRacqus.datapath(1:length(NMRacqus.datapath)));    cd ..    for nexp = 1:length(expno)        eval(['cd ' num2str(expno(nexp))])        load NMRacqus        if strcmp(NMRacqus.nuc2,'off') == 1            fprintf(fid,'%s\r',[num2str(expno(nexp)) ') ' NMRacqus.nuc1 ', ' NMRacqus.pulprog]);        else            fprintf(fid,'%s\r',[num2str(expno(nexp)) ') ' NMRacqus.nuc1 '-' NMRacqus.nuc2 ', ' NMRacqus.pulprog]);        end        fprintf(fid,'%s\r',NMRacqus.probhd);        fprintf(fid,'%s\r',['sw=' num2str(NMRacqus.sw,4) 'ppm, td=' num2str(NMRacqus.td,'%i') ', p1=' num2str(NMRacqus.p(2),4) 'us, pl1=' num2str(NMRacqus.pl(2),4) 'dB, de=' num2str(NMRacqus.de,4) 'us, d1=' num2str(NMRacqus.d(2),4) 's, ns=' num2str(NMRacqus.ns,'%i')]);        if strcmp(NMRacqus.nuc2,'off') == 0            fprintf(fid,'%s\r',['p3=' num2str(NMRacqus.p(4),4) 'us, pl2=' num2str(NMRacqus.pl(3),4) 'dB']);        end        if any(strcmp(NMRacqus.pulprog,{'hpdec.av','hxhetcor.av','DT_cp','ineptrd','DT_rpdlf'...                ,'DT_cprpdlf','DT_inept'})) == 1            aq = .5/NMRacqus.sw_h*NMRacqus.td;            fprintf(fid,'%s\r',['cpdprg2=' NMRacqus.cpdprg2 ', pl12=' num2str(NMRacqus.pl(13),4) 'dB, p31=' num2str(NMRacqus.p(32),4) 'us, aq=' num2str(aq*1e3,4) 'ms']);        end        if any(strcmp(NMRacqus.pulprog,{'DT_imse1dcs','DT_im1dcs'})) == 1           aq = .5/NMRacqus.sw_h*NMRacqus.td;           fprintf(fid,'%s\r',['aq=' num2str(aq*1e3,4) 'ms swh=' num2str(NMRacqus.sw_h,4) 'Hz cnst23=' num2str(NMRacqus.cnst(24),2) ' d2=' num2str(NMRacqus.d(3)*1e3,4) 'ms  d3=' num2str(NMRacqus.d(4)*1e3,4) 'ms']);        end        if any(strcmp(NMRacqus.pulprog,{'DT_cp','DT_cprpdlf'})) == 1            fprintf(fid,'%s\r',['p15=' num2str(NMRacqus.p(16),4) 'us, pl21=' num2str(NMRacqus.pl(22),4) 'dB, pl22=' num2str(NMRacqus.pl(23),4) 'dB, spnam0='  NMRacqus.spnam0]);        end        if any(strcmp(NMRacqus.pulprog,{'DT_imsepisp'})) == 1            fprintf(fid,'%s\r',['p3=' num2str(NMRacqus.p(4),4) 'us, pl11=' num2str(NMRacqus.pl(12),4) 'dB, spnam3='  NMRacqus.spnam3]);        end        if any(strcmp(NMRacqus.pulprog,{'DT_imepi2'})) == 1            fprintf(fid,'%s',['cnst14=' num2str(NMRacqus.cnst(15),4) ', ']);        end        if any(strcmp(NMRacqus.pulprog,{'DT_imepi','DT_imsepi','DT_imsepisp','DT_imepi2'})) == 1            fprintf(fid,'%s\r',['cnst13=' num2str(NMRacqus.cnst(14),4) ', cnst22=' num2str(NMRacqus.cnst(23),4) ', l1=' num2str(NMRacqus.l(2),'%i')]);        end        if any(strcmp(NMRacqus.pulprog,{'DT_pgsteC3D'})) == 1            fprintf(fid,'%s\r',['cnst1=' num2str(NMRacqus.cnst(2),4) ', cnst2=' num2str(NMRacqus.cnst(3),4) ', cnst3=' num2str(NMRacqus.cnst(4),4) ', d3=' num2str(NMRacqus.d(4)*1e3,3) 'ms, d5=' num2str(NMRacqus.d(6)*1e3,3) 'ms']);        end        if exist('NMRacqu2s.mat') == 2            load NMRacqu2s            fprintf(fid,'%s\r',['sw1=' num2str(NMRacqu2s.sw,4) 'ppm, td1=' num2str(NMRacqu2s.td,4)]);        end        if any(strcmp(NMRacqus.pulprog,{'DT_rpdlf','DT_cprpdlf'})) == 1            aq1 = 4*NMRacqus.p(33)*NMRacqus.l(2)*NMRacqu2s.td;            fprintf(fid,'%s\r',['l1=' num2str(NMRacqus.l(2),'%i') ', pl32=' num2str(NMRacqus.pl(33),4) 'dB, p32=' num2str(NMRacqus.p(33),4) 'us, td1=' num2str(NMRacqu2s.td,'%i') ', aq1=' num2str(aq1*1e-3,4) 'ms']);        end        if any(strcmp(NMRacqus.probhd,{'4 mm MAS BB/1H K3167/0111','4 mm HRMAS 1H-13C/31P Z-GRD B3175/0415'})) == 1            fprintf(fid,'%s',['masr=' num2str(NMRacqus.masr*1e-3,4) 'kHz, ']);        end        fprintf(fid,'%s\r',['te=' num2str(NMRacqus.te,4) 'K']);        fprintf(fid,'%s\r',NMRacqus.datetimeuser);                if exist('pdata') == 7            cd pdata, cd 1            fid2 = fopen('title','rt');            templine = fgetl(fid2);            while ischar(templine)                fprintf(fid,'%s\r',templine);                templine = fgetl(fid2);            end            fclose(fid2);            fprintf(fid,'%s\r','');            cd .., cd ..        end        cd ..    end    fclose(fid);endres = 1;