function Y = fexpDTI(Pin,Xin,Pnorm,Xnorm,Ynorm,Gnorm);Pin = Pin.*Pnorm;Xin = Xin*Xnorm;Y0 = Pin(1);lambda.x = Pin(2);lambda.y = Pin(3);lambda.z = Pin(4);A.alpha = Pin(5);A.beta = Pin(6);A.gamma = Pin(7);R.gamma = [    cos(A.gamma) sin(A.gamma) 0    -sin(A.gamma) cos(A.gamma) 0    0 0 1];R.beta = [    cos(A.beta) 0 -sin(A.beta)    0 1 0    sin(A.beta) 0 cos(A.beta)];R.alpha = [    cos(A.alpha) sin(A.alpha) 0    -sin(A.alpha) cos(A.alpha) 0    0 0 1];R.mat = R.gamma*R.beta*R.alpha;R.inv = inv(R.mat);DT_PAS = [    lambda.x 0 0    0 lambda.y 0    0 0 lambda.z];DT_LF = R.mat*DT_PAS*R.inv;GDG = DT_LF(1,1)*Gnorm.x.^2 + DT_LF(2,2)*Gnorm.y.^2 + DT_LF(3,3)*Gnorm.z.^2 ...    + 2*DT_LF(1,2)*Gnorm.x.*Gnorm.y + 2*DT_LF(1,3)*Gnorm.x.*Gnorm.z + 2*DT_LF(2,3)*Gnorm.y.*Gnorm.z;GDG(isnan(GDG)) = (lambda.x+lambda.y+lambda.z)/3;Y = Y0.*exp( - GDG.*Xin);Y = Y/Ynorm;