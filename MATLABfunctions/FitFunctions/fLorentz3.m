function Y = fLorentz3(Pin,Xin,Pnorm,Xnorm,Ynorm,Para);Pin = Pin.*Pnorm;nu = Xin*Xnorm;npeak = length(Pin)/2;T2 = Pin(1:npeak);S0 = Pin(npeak+1:2*npeak);offset = Para(1:npeak);phase = 0;Icalc = zeros(size(nu));for npeak = 1:length(S0)	Icalc = Icalc + S0(npeak)*T2(npeak)./(1+(nu-offset(npeak)).^2*T2(npeak)^2).*(1 - i*(nu-offset(npeak))*T2(npeak))*exp(i*phase);endIcalc = real(Icalc);Y = Icalc/Ynorm;if any([S0 T2]<0) == 1	Y = ones(size(Y));end