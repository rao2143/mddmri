function I = fSuperLorentz(nu,ampl,T2min,T2max,offset,phase)Ntheta = 50;theta = linspace(0,pi,Ntheta+1)';dtheta = theta(2)-theta(1);theta = theta(1:Ntheta)+dtheta/2;[nuarray,thetaarray] = ndgrid(nu,theta);T2array = 1./(1/T2max + 1/T2min*abs(.5*(3*cos(thetaarray).^2-1)));Inutheta = ampl*T2array./(1+(nuarray-offset).^2.*T2array.^2).*(1 - 1i*(nuarray-offset).*T2array)*exp(1i*phase).*sin(thetaarray);I = sum(Inutheta,2);