function Y = fCRLN(Pin,Xin,C,kwkc,delta,tao2,DELTA,Pnorm,Xnorm,Ynorm)k = Xin*Xnorm;Pin = Pin.*Pnorm;Dmean = Pin(1);sigma = Pin(2);I0 = Pin(3:length(Pin));[temp, I0] = ndgrid(ones(length(k)/length(I0),1), I0);I0 = reshape(I0,prod(size(I0)),1);D0 = Dmean/exp(sigma^2/2);Dmax = D0/exp(sigma^2);N = 100;D = logspace(log10(Dmax)-3*sigma,log10(Dmax)+3*sigma,N+1)';dD = diff(D);D = D(1:N) + dD/2;PD = 1./(D.*sigma*sqrt(2*pi)).*exp(-1/2*((log(D)-log(D0))./sigma).^2);%figure(1), semilogx(D,PD), return[karray, Darray] = ndgrid(k,D);[DELTAarray, PDarray] = ndgrid(DELTA,PD);[tao2array, PDarray] = ndgrid(tao2,PD);A = karray.*Darray./(DELTAarray-delta/3);B = sqrt((A + C).^2 + 4*kwkc);B0 = sqrt(C.^2 + 4*kwkc);EkD = exp(-karray.*Darray).*exp(A.*tao2array/2).*(cosh(B.*tao2array/2)-(A+C)./B.*sinh(B.*tao2array/2))./(cosh(B0.*tao2array/2)-C./B0.*sinh(B0.*tao2array/2));EkD(find(isnan(EkD)==1)) = 0;EkD(find(EkD==Inf)) = 0;Ek = (PDarray.*EkD)*dD;%figure(1), semilogy(k,Ek,'o'), returnIk = I0.*Ek;Y = Ik/Ynorm;