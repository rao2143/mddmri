function M = fGS(Pin,Xin,tao1,wL,wG,Pnorm,Xnorm,Ynorm)tao2 = Xin*Xnorm;Pin = Pin.*Pnorm;M0 = Pin(1);kw = Pin(2);kc = Pin(3);R1w = Pin(4);R1c = Pin(5);eff = Pin(6);Rplus = 0.5*(kw+R1w+kc+R1c+sqrt((kw+R1w-kc-R1c)^2 + 4*kw*kc));Rminus = 0.5*(kw+R1w+kc+R1c-sqrt((kw+R1w-kc-R1c)^2 + 4*kw*kc));deltamw0 = eff*exp(-pi*wL.*tao1 - (pi*wG.*tao1/2/sqrt(log(2))).^2) - 1;cplus = deltamw0.*(kw + R1w - Rminus)./(Rplus - Rminus) + kw./(Rplus - Rminus);cminus = -deltamw0.*(kw + R1w - Rplus)./(Rplus - Rminus) - kw./(Rplus - Rminus);M = M0.*(1 + cplus.*exp(-Rplus.*tao2) + cminus.*exp(-Rminus.*tao2));M = M/Ynorm;