function Y = fbiLN(Pin,Xin,Pnorm,Xnorm,Ynorm);Pin = Pin.*Pnorm;Xin = Xin*Xnorm;I0 = Pin(1);Dmeanf = Pin(2);sigmaf = Pin(3);Dmeans = Pin(4);sigmas = Pin(5);ff = Pin(6);D0f = Dmeanf/exp(sigmaf^2/2);Dmaxf = D0f/exp(sigmaf^2);N = 100;Df = logspace(log10(Dmaxf)-3*sigmaf,log10(Dmaxf)+3*sigmaf,N);[karray, Dfarray] = ndgrid(Xin,Df);SDf = 1./(Dfarray.*sigmaf*sqrt(2*pi)).*exp(-1/2*((log(Dfarray)-log(D0f))./sigmaf).^2).*exp(-karray.*Dfarray);mSDf = (SDf(:,1:(N-1)) + SDf(:,2:N))/2;dDf = Df(2:N) - Df(1:(N-1));D0s = Dmeans/exp(sigmas^2/2);Dmaxs = D0s/exp(sigmas^2);N = 100;Ds = logspace(log10(Dmaxs)-3*sigmas,log10(Dmaxs)+3*sigmas,N);[karray, Dsarray] = ndgrid(Xin,Ds);SDs = 1./(Dsarray.*sigmas*sqrt(2*pi)).*exp(-1/2*((log(Dsarray)-log(D0s))./sigmas).^2).*exp(-karray.*Dsarray);mSDs = (SDs(:,1:(N-1)) + SDs(:,2:N))/2;dDs = Ds(2:N) - Ds(1:(N-1));Y = I0.*(ff.*mSDf*dDf' + (1-ff).*mSDs*dDs');Y = Y/Ynorm;