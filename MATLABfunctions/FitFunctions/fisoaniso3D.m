function Y = fisoaniso3D(Pin,Xin1,Xin2,Pnorm,Xnorm,Ynorm)if nargin == 3    Pnorm = ones(size(Pin));    Xnorm = 1;    Ynorm = 1;endPin = Pin.*Pnorm;Xin1 = Xin1*Xnorm;Xin2 = Xin2*Xnorm;I0 = Pin(1);Dpar = Pin(2);Dperp = Pin(3);Dmean = (Dpar + 2*Dperp)/3;b = Xin2;biso = Xin1;if Dpar>Dperp    E = sqrt(pi)/2*exp(-b*Dperp)./sqrt(b*(Dpar-Dperp)).*erf(sqrt(b*(Dpar-Dperp)));elseif Dperp>Dpar    E = sqrt(pi)/2*exp(-b*Dperp)./sqrt(b*(Dpar-Dperp))*i.*erfi(imag(sqrt(b*(Dpar-Dperp))));else    E = exp(-b*Dperp);endEiso = exp(-biso*Dmean);Y = I0*E.*Eiso;Y = Y/Ynorm;