function Y = fSGPplaneDfree(Pin,Xin,Pnorm,Xnorm,Ynorm,D,DELTA);Pin = Pin.*Pnorm;q = Xin*Xnorm;Y0 = Pin(1);a = Pin(2);ff = Pin(3)/(Y0+Pin(3));N = 100;n = 1:N;[qarray, narray] = ndgrid(q,n);S = exp(-narray.^2*pi^2*D*DELTA/a^2).*(1-(-1).^narray.*cos(2*pi*qarray*a))./((2*pi*qarray*a).^2-(narray*pi).^2).^2;E = 2*(1-cos(2*pi*q*a))./(2*pi*q*a).^2 + 4*(2*pi*q*a).^2.*sum(S,2);Y = Y0.*((1-ff)*E + ff*exp( - D.*(2*pi*q).^2*DELTA));Y = Y/Ynorm;if ff>0.5 |ff<0, Y = Y*10; end