function Y = fvesicle(Pin,Xin,Pnorm,Xnorm,Ynorm);Pin = Pin.*Pnorm;Xin = Xin*Xnorm;I0 = Pin(1);Dmean = Pin(2);N = 300;D0 = 2*Dmean;D = logspace(log10(D0)-2,log10(D0)+1,N);dD = diff(D);D = D(1:(N-1)) + dD/2;PD = 1/2*exp(-D0./D)*D0^3./D.^4;[karray, Darray] = ndgrid(Xin,D);[karray, PDarray] = ndgrid(Xin,PD);SD = PDarray.*exp(-karray.*Darray);Y = I0.*SD*dD';Y = Y/Ynorm;