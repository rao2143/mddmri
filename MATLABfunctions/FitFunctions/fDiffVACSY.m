function Y = fDiffVACSY(Pin,Xin,Xin2,Pnorm,Xnorm,Ynorm)if nargin == 3    Pnorm = ones(size(Pin));    Xnorm = 1;    Ynorm = 1;endPin = Pin.*Pnorm;Xin = Xin*Xnorm;I0 = Pin(1);Dpar = Pin(2);Dperp = Pin(3);MD = (Dpar + 2*Dperp)/3;DD = Dpar - Dperp;b = Xin;% zeta = Xin2;% Dpar_zeta = MD + 2/3*DD*(3*cos(zeta).^2-1)/2;% Dperp_zeta = MD - 1/3*DD*(3*cos(zeta).^2-1)/2;Deltab = Xin2;Dpar_zeta = MD + 2/3*DD*Deltab;Dperp_zeta = MD - 1/3*DD*Deltab;E_prolate = zeros(size(Xin));E_oblate = E_prolate;E_iso = E_prolate;E_temp = sqrt(pi)/2*exp(-b.*Dperp_zeta)./sqrt(b.*(Dpar_zeta-Dperp_zeta)).*erf(sqrt(b.*abs(Dpar_zeta-Dperp_zeta)));indx = Dpar_zeta>Dperp_zeta;E_prolate(indx) = E_temp(indx);E_temp = sqrt(pi)/2*exp(-b.*Dperp_zeta)./sqrt(b.*(Dpar_zeta-Dperp_zeta))*1i.*erfi(imag(sqrt(b.*(Dpar_zeta-Dperp_zeta))));indx = Dpar_zeta<Dperp_zeta;E_oblate(indx) = E_temp(indx);E_temp = exp(-b.*Dperp_zeta);indx = Dpar_zeta==Dperp_zeta;E_iso(indx) = E_temp(indx);E = E_prolate + E_oblate + E_iso;E(b == 0) = 1;I = I0*E;I = real(I);Y = I/Ynorm;